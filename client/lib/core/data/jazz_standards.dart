/// Known jazz standard titles for fuzzy matching against OCR results.
///
/// Song titles are not copyrightable — this is a factual reference list
/// compiled from published Real Book indices and jazz standard databases.
class JazzStandards {
  JazzStandards._();

  /// Find the best matching known title for an OCR'd string.
  /// Returns the known title if similarity >= [threshold] (0.0–1.0),
  /// otherwise returns null.
  static String? fuzzyMatch(String ocrTitle, {double threshold = 0.65}) {
    if (ocrTitle.isEmpty) return null;
    final lower = ocrTitle.toLowerCase().trim();
    if (lower.isEmpty) return null;

    String? bestMatch;
    double bestScore = 0;

    for (final known in titles) {
      final knownLower = known.toLowerCase();
      // Quick exact check.
      if (lower == knownLower) return known;

      final score = _similarity(lower, knownLower);
      if (score > bestScore) {
        bestScore = score;
        bestMatch = known;
      }
    }

    return bestScore >= threshold ? bestMatch : null;
  }

  /// Normalized string similarity (0.0–1.0) using Levenshtein distance.
  static double _similarity(String a, String b) {
    if (a == b) return 1.0;
    if (a.isEmpty || b.isEmpty) return 0.0;
    final dist = _levenshtein(a, b);
    final maxLen = a.length > b.length ? a.length : b.length;
    return 1.0 - (dist / maxLen);
  }

  /// Levenshtein edit distance (optimised single-row DP).
  static int _levenshtein(String a, String b) {
    if (a.length < b.length) {
      final tmp = a;
      a = b;
      b = tmp;
    }
    final m = a.length, n = b.length;
    var prev = List<int>.generate(n + 1, (i) => i);
    var curr = List<int>.filled(n + 1, 0);

    for (int i = 1; i <= m; i++) {
      curr[0] = i;
      for (int j = 1; j <= n; j++) {
        final cost = a[i - 1] == b[j - 1] ? 0 : 1;
        curr[j] = [
          prev[j] + 1, // deletion
          curr[j - 1] + 1, // insertion
          prev[j - 1] + cost, // substitution
        ].reduce((a, b) => a < b ? a : b);
      }
      final tmp = prev;
      prev = curr;
      curr = tmp;
    }
    return prev[n];
  }

  /// Comprehensive list of jazz standard titles from Real Book volumes,
  /// New Real Book, Standards Real Book, and other common fake books.
  static const List<String> titles = [
    "'Round Midnight",
    "'S Wonderful",
    "2 Degrees East, 3 Degrees West",
    "26-2",
    "34 Skidoo",
    "4 A.M.",
    "500 Miles High",
    "502 Blues",
    "A Child Is Born",
    "A Family Joy",
    "A Fine Romance",
    "A Foggy Day",
    "A Night In Tunisia",
    "A Sleepin' Bee",
    "Actual Proof",
    "African Flower",
    "Afro Blue",
    "Afro-Centric",
    "After The Love Has Gone",
    "After The Rain",
    "After You've Gone",
    "Afternoon In Paris",
    "Again",
    "Airegin",
    "Ain't Misbehavin'",
    "Ain't No Sunshine",
    "Alice In Wonderland",
    "All Blues",
    "All My Tomorrows",
    "All Of Me",
    "All Of You",
    "All Or Nothing At All",
    "All The Things You Are",
    "All The Way",
    "All Through The Night",
    "Alone Together",
    "Along Came Betty",
    "Always There",
    "Ana Maria",
    "And On The Third Day",
    "And The Angels Sing",
    "Angel Eyes",
    "Anthropology",
    "April In Paris",
    "April Joy",
    "Are You Real?",
    "Arise, Her Eyes",
    "Armageddon",
    "Around Again",
    "As Time Goes By",
    "Au Privave",
    "Autumn In New York",
    "Autumn Leaves",
    "Bags' Groove",
    "Ballad For Trane",
    "Basin Street Blues",
    "Beautiful Love",
    "Beauty And The Beast",
    "Bebop",
    "Begin The Beguine",
    "Beneath It All",
    "Bernie's Tune",
    "Bessie's Blues",
    "Bewitched",
    "Big Nick",
    "Bird Food",
    "Birdland",
    "Bitter Suite In The Ozone",
    "Black Diamond",
    "Black Narcissus",
    "Black Nile",
    "Black Orpheus",
    "Blame It On My Youth",
    "Blessed Relief",
    "Blue Bossa",
    "Blue Comedy",
    "Blue Daniel",
    "Blue In Green",
    "Blue Monk",
    "Blue Room",
    "Blue Seven",
    "Blue Train",
    "Blues Connotation",
    "Blues For Alice",
    "Blues In The Closet",
    "Blues In The Night",
    "Bluesette",
    "Body And Soul",
    "Bolivia",
    "Boplicity",
    "Born To Be Blue",
    "Boston Marathon",
    "Bouncin' With Bud",
    "Brainville",
    "Bright Size Life",
    "Broadway Blues",
    "Brownout",
    "But Beautiful",
    "But Not For Me",
    "Butterfly",
    "Bye Bye Blackbird",
    "Cantaloupe Island",
    "Canyon Song",
    "Captain Marvel",
    "Caravan",
    "Central Park West",
    "Ceora",
    "Charade",
    "Chega De Saudade",
    "Chelsea Bells",
    "Chelsea Bridge",
    "Cherokee",
    "Chicken Feathers",
    "Children's Song",
    "Chippie",
    "Close Enough For Love",
    "Close To You",
    "Close Your Eyes",
    "Cold Duck Time",
    "Colors Of Chloe",
    "Come Sunday",
    "Como En Vietnam",
    "Compared To What",
    "Con Alma",
    "Conception",
    "Conference Of Birds",
    "Confirmation",
    "Coral",
    "Corcovado",
    "Cottontail",
    "Could It Be You",
    "Countdown",
    "Country Roads",
    "Crescent",
    "Crystal Silence",
    "Cute",
    "Daahoud",
    "Dancing On The Ceiling",
    "Darn That Dream",
    "Day By Day",
    "Day Dream",
    "Days And Nights Waiting",
    "Days Of Wine And Roses",
    "Day Waves",
    "Dear Lord",
    "Dear Old Stockholm",
    "Dearly Beloved",
    "Delores",
    "Deluge",
    "De Pois De Amor O'Vazio",
    "Desafinado",
    "Desert Air",
    "Dexterity",
    "Dig",
    "Dindi",
    "Django",
    "Do Nothing Till You Hear From Me",
    "Doin' The Pig",
    "Dolphin Dance",
    "Dolphin, The",
    "Domino Biscuit",
    "Don't Blame Me",
    "Don't Get Around Much Anymore",
    "Don't Go To Strangers",
    "Don't Worry 'Bout Me",
    "Donna Lee",
    "Doodlin'",
    "Duplicities",
    "Duke, The",
    "E.S.P.",
    "Easy Living",
    "Easy To Love",
    "Ecclesiastics",
    "Eiderdown",
    "Eighty One",
    "El Gaucho",
    "Eli's Theme",
    "Emily",
    "Empathy",
    "Epistrophy",
    "Equinox",
    "Equipoise",
    "Evidence",
    "Exercise",
    "Fables Of Faubus",
    "Fall",
    "Falling Grace",
    "Falling In Love With Love",
    "Fee-Fi-Fo-Fum",
    "Feelings And Things",
    "Fields We Know, The",
    "Five Hundred Miles High",
    "Flags",
    "Fly Me To The Moon",
    "Follow Your Heart",
    "Footprints",
    "For Heaven's Sake",
    "Forest Flower",
    "Fortune Smiles",
    "Four",
    "Four On Six",
    "Four Winds",
    "Freddie The Freeloader",
    "Freedom Jazz Dance",
    "Gary's Waltz",
    "Gemini",
    "General Mojo's Well Laid Plan",
    "Gentle Rain",
    "Giant Steps",
    "Girl From Ipanema, The",
    "Gloria's Step",
    "God Bless The Child",
    "Golden Lady",
    "Gone With The Wind",
    "Good Evening Mr. And Mrs. America",
    "Goodbye",
    "Goodbye Pork Pie Hat",
    "Grand Central",
    "Green Dolphin Street",
    "Green Mountains",
    "Groovin' High",
    "Half Nelson",
    "Hassan's Dream",
    "Have You Met Miss Jones",
    "Heaven",
    "Hello Lovers",
    "Here's That Rainy Day",
    "Herzog",
    "Hold Out Your Hand",
    "Hotel Hello",
    "Hotel Overture",
    "Hotel Vamp",
    "House Of Jade",
    "How Deep Is The Ocean",
    "How High The Moon",
    "How Insensitive",
    "How My Heart Sings",
    "Hullo, Bolinas",
    "I Can't Get Started",
    "I Could Write A Book",
    "I Got It Bad",
    "I Let A Song Go Out Of My Heart",
    "I Love You",
    "I Mean You",
    "I Remember Clifford",
    "I Should Care",
    "I'll Remember April",
    "I'm All Smiles",
    "I'm Your Pal",
    "Icarus",
    "Ictus",
    "Ida Lupino",
    "If You Could See Me Now",
    "Impressions",
    "In A Mellow Tone",
    "In A Sentimental Mood",
    "Inchworm",
    "Indian Lady",
    "Inner Urge",
    "Inside In",
    "Interplay",
    "Intrepid Fox",
    "In Your Own Sweet Way",
    "In Your Quiet Place",
    "Iris",
    "Isn't It Romantic",
    "Isotope",
    "Israel",
    "It Don't Mean A Thing",
    "It's A Raggy Waltz",
    "Jelly",
    "Jinrikisha",
    "Jordu",
    "Journey To Recife",
    "Joy Spring",
    "Ju-Ju",
    "Jump Monk",
    "June 15th, 1967",
    "Just Friends",
    "Lady Bird",
    "La Fiesta",
    "Lament",
    "Las Vegas Tango",
    "Lazy Bird",
    "Leroy The Magician",
    "Lie Awake",
    "Like Someone In Love",
    "Limehouse Blues",
    "Line For Lyons",
    "Litha",
    "Little B's Poem",
    "Little Niles",
    "Little Waltz",
    "Liturgy",
    "Long Ago And Far Away",
    "Lonnie's Lament",
    "Look To The Sky",
    "Looking Back",
    "Lucky Southern",
    "Lullaby Of Birdland",
    "Lush Life",
    "Magician In You, The",
    "Maiden Voyage",
    "Man In The Green Shirt",
    "May Dance",
    "Meditation",
    "Memories Of Tomorrow",
    "Memphis Underground",
    "Mevlevia",
    "Michelle",
    "Midnight Mode",
    "Milano",
    "Minority",
    "Misty",
    "Miyako",
    "Moment's Notice",
    "Molten Glass",
    "Montage",
    "Mood Indigo",
    "Moon Germs",
    "Moonchild",
    "More I See You, The",
    "Mother Of The Dead Man",
    "Mr. Clean",
    "My Favorite Things",
    "My Foolish Heart",
    "My Funny Valentine",
    "My Little Boat",
    "My One And Only Love",
    "My Romance",
    "My Ship",
    "Mysterious Traveler",
    "Naima",
    "Nardis",
    "Nefertiti",
    "Never Will I Marry",
    "Nica's Dream",
    "Night And Day",
    "Night Dreamer",
    "Night Has A Thousand Eyes, The",
    "Nimbus",
    "Nonsequence",
    "Nostalgia In Times Square",
    "Oleo",
    "Olhos De Gato",
    "Once I Loved",
    "One Finger Snap",
    "One Note Samba",
    "Open Your Eyes, You Can Fly",
    "Orbits",
    "Ornithology",
    "Out Of Nowhere",
    "Passion Dance",
    "Peace",
    "Peaches En Regalia",
    "Pearlie's Swine",
    "Pee Wee",
    "Peggy's Blue Skylight",
    "Pensativa",
    "Pent-Up House",
    "Peri's Scope",
    "Pinocchio",
    "Pithecanthropus Erectus",
    "Played Twice",
    "Portsmouth Figurations",
    "Prancing (No Blues)",
    "Prelude To A Kiss",
    "Prince Of Darkness",
    "Pussy Cat Dues",
    "Quiet Now",
    "Raven, The",
    "Recorda Me",
    "Red Baron, The",
    "Red Clay",
    "Reflections",
    "Revelation",
    "Ruby, My Dear",
    "Sack Full Of Dreams",
    "Sadu",
    "Saint Thomas",
    "Samba De Orfeu",
    "Satin Doll",
    "Scrapple From The Apple",
    "Search For Peace",
    "Serenade To A Bus Seat",
    "Serenade To A Cuckoo",
    "Seven Steps To Heaven",
    "Sidewinder, The",
    "Silver's Serenade",
    "Since I Fell For You",
    "Skating In Central Park",
    "Skylark",
    "So Near, So Far",
    "So What",
    "Softly As In A Morning Sunrise",
    "Solar",
    "Some Day My Prince Will Come",
    "Song For My Father",
    "Sophisticated Lady",
    "Space Circus",
    "Speak Low",
    "Speak No Evil",
    "Stella By Starlight",
    "Stolen Moments",
    "Stompin' At The Savoy",
    "Straight No Chaser",
    "Street Of Dreams",
    "Strollin'",
    "Sugar",
    "Summer Night",
    "Summertime",
    "Surrey With The Fringe On Top, The",
    "Sweet And Lovely",
    "Sweet Georgia Brown",
    "Take Five",
    "Take The A Train",
    "Teach Me Tonight",
    "Tenderly",
    "That's All",
    "The Duke",
    "The Jody Grind",
    "Theme For Ernie",
    "There Is No Greater Love",
    "There Will Never Be Another You",
    "These Foolish Things",
    "Things Ain't What They Used To Be",
    "Thinking Of You",
    "This Could Be The Start Of Something",
    "This Masquerade",
    "Three Views Of A Secret",
    "Time Remembered",
    "Tones For Joan's Bones",
    "Trinkle Tinkle",
    "Triste",
    "Tune Up",
    "Turn Out The Stars",
    "Turning Point, The",
    "Ugly Beauty",
    "Un Poco Loco",
    "Unforgettable",
    "Unit Seven",
    "Up Jumped Spring",
    "Upper Manhattan Medical Group",
    "Valse Hot",
    "Very Early",
    "Virgo",
    "Voyage",
    "Wait Till You See Her",
    "Waltz For Debby",
    "Watch What Happens",
    "Watermelon Man",
    "Wave",
    "We'll Be Together Again",
    "Well You Needn't",
    "West Coast Blues",
    "What A Wonderful World",
    "What Is This Thing Called Love",
    "What's New",
    "When I Fall In Love",
    "When Sunny Gets Blue",
    "Where Or When",
    "Whisper Not",
    "Wild Flower",
    "Willow Weep For Me",
    "Windows",
    "Witch Hunt",
    "Woody'n You",
    "Work Song",
    "Yardbird Suite",
    "Yesterdays",
    "You And The Night And The Music",
    "You Are Too Beautiful",
    "You Don't Know What Love Is",
    "You Go To My Head",
    "You Stepped Out Of A Dream",
    "You'd Be So Nice To Come Home To",
    "Young And Foolish",
  ];
}
